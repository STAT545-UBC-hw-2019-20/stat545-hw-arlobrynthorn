---
title: "hw04"
author: "Arlo"
output: 
  html_document:
    toc: yes
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, warning = FALSE, echo = FALSE, message = FALSE}
library(dplyr)
library(gapminder)
library(tidyverse)
library(tsibble)
library(scales)
```

# Exercise 1 (Univariate Option 1)

## 1.1: Tibble of life expectancy over time for Canada and Rwanda 

Filter gapminder data by selecting Canadian and Rwandan data, then select so that data is organized by country then year in ascending order, then lifeExp. Organize data into a tibble where each row is a unique observation (year), then shows Canadian and Rwandan life expectancy in their own columns.  
```{r}
gapminder %>% 
  filter(country == "Canada" | country == "Rwanda") %>%
  select(country, year, lifeExp) %>% 
  pivot_wider(id_cols        = year, 
              names_from  = country, 
              values_from = lifeExp)
```

## 1.2: Scatterplot of Canadian and Rwandan life expectancy over time

Plot data against eachother, showing how change in life expectancy over time compares between Canada and Rwanda
```{r}
gapminder %>% 
  filter(country == "Canada" | country == "Rwanda") %>%
  select(country, year, lifeExp) %>% 
  pivot_wider(id_cols        = year, 
              names_from  = country, 
              values_from = lifeExp) %>% 
  ggplot(aes(Canada, Rwanda)) +
  geom_point() +
  theme_bw() +
  geom_text(aes(label=year),hjust=0, vjust=0)
```

## 1.3: Re-lengthening data

Relengthen data back into long format. 
```{r}
gapminder %>% 
  filter(country == "Canada" | country == "Rwanda") %>%
  select(country, year, lifeExp) %>% 
  pivot_wider(id_cols        = year, 
              names_from  = country, 
              values_from = lifeExp) %>%
  pivot_longer(cols = c(Canada, Rwanda), 
               names_to = "country", 
               values_to = "lifeExp") 
```

# Exercise 2 (Multivariate Option 1)

## 2.1: Tibble showing Canadian and Rwandan lifeExp and gdpPercap per year 

Add columns showing lifeExp and gdpPercap for Canada and Rwanda (separately).
```{r}
gapminder %>% 
  filter(country == "Canada" | country == "Rwanda") %>%
  select(country, year, lifeExp, gdpPercap) %>% 
  pivot_wider(id_cols        = year, 
              names_from  = country,
              names_sep = "_",
              values_from = c(lifeExp, gdpPercap))
```

## 2.2: Re-lengthening data

Relengthen data back into long format. 
```{r}
gapminder %>% 
  filter(country == "Canada" | country == "Rwanda") %>%
  select(country, year, lifeExp, gdpPercap) %>% 
  pivot_wider(id_cols        = year, 
              names_from  = country,
              names_sep = "_",
              values_from = c(lifeExp, gdpPercap)) %>%
  pivot_longer(cols = -year,
               names_sep = "_",
               names_to = c(".value", "country"))
```


# Exercise 3

Gather data from online repository.
```{r}
guest <- read_csv("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/attend.csv")
email <- read_csv("https://raw.githubusercontent.com/STAT545-UBC/Classroom/master/data/wedding/emails.csv")
```

## 3.0: Visualize data

Print out unfamiliar datasets to visualize for best analysis.
```{r}
guest
email
```

## 3.1-1: Put guests in "email" data unique rows to then add to "guestlist" data

Define new variable that will hold the newly separated list of emails.
```{r}
email_separate <- email %>% 
  separate_rows(guest, sep = ", ")
```
##3.1-2: Add column for email to guestlist data

Join new dataset held in new variable to "guest" dataset.
```{r}
guest %>%
  left_join(email_separate, c("name" = "guest")) 
```


## 3.2: Non-guestlist emails identified

Find out who has email data that is not on the guestlist.
```{r}
email_separate %>% 
  anti_join(guest, c("guest" = "name"))
```

## 3.3: Create full guestlist

Join data for all guests whether or not the have an email associated with them (using full_join() allows for "N/A" observations to be included)
```{r}
guest %>% 
  full_join(email_separate, c("name" = "guest")) 
```